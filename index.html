<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>l.js</title>
    <script src="./l.js"></script>
    <script>
        function eval() {
            let vm = new Interpreter();
            CoreLib.registerLib(vm);

            document.getElementById("output").value = "";
            document.getElementById("result").value = "";

            outputStr = "";
            CoreLib.inputCallback = function () {
                return prompt("Input", "");
            };
            CoreLib.outputCallback = function (s) {
                outputStr += `${s}\n`;
                document.getElementById("output").value = outputStr;
            };
            let src = document.getElementById("input").value;
            try {
                let ret = vm.rep(`(do ${src})`);
                document.getElementById("result").value = ret;
            } catch (error) {
                document.getElementById("result").value = error.message;
            }
        }
    </script>
</head>

<body>
    <div>input</div>
    <textarea name="input" id="input" cols="100" rows="10"></textarea>
    <div>output</div>
    <textarea name="output" id="output" cols="100" rows="10"></textarea>
    <div>result</div>
    <textarea name="result" id="result" cols="100" rows="10"></textarea>
    <button onclick="eval()">Eval</button>
</body>

</html>
